# –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API

## 1. –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ amount

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞:
```javascript
// UniFarmingCard.tsx, —Å—Ç—Ä–æ–∫–∏ 156-178
const requestBody = {
  amount: amount.toString(),  // –ü–µ—Ä–µ–¥–∞–µ–º amount –∫–∞–∫ —Å—Ç—Ä–æ–∫—É
  user_id: 1  // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ —á–∏—Å–ª–æ
};

// –Ø–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ amount –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
console.log('–¢–∏–ø:', typeof requestBody.amount, requestBody.amount);

// –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º number –≤ string –µ—Å–ª–∏ amount —á–∏—Å–ª–æ
if (typeof requestBody.amount === 'number') {
  console.log(`üì§ [–û–¢–õ–ê–î–ö–ê –î–ï–ü–û–ó–ò–¢–ê] amount –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑ —á–∏—Å–ª–∞ –≤ —Å—Ç—Ä–æ–∫—É`);
  requestBody.amount = String(requestBody.amount);
}
```

### –ü—Ä–æ–±–ª–µ–º–∞:
1. –ò–∑–±—ã—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
2. –ù–µ—Å–∫–æ–ª—å–∫–æ —É—á–∞—Å—Ç–∫–æ–≤ –∫–æ–¥–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –∑–∞–¥–∞—á—É
3. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ BigNumber.toString() —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞, –Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ number

### –†–µ—à–µ–Ω–∏–µ:
```javascript
// –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
const requestBody = {
  amount: String(amount), // –ï–¥–∏–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Å—Ç—Ä–æ–∫—É
  user_id: 1
};

console.log('–î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞:', requestBody);
```

---

## 2. –ü—Ä–æ–±–ª–µ–º–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–≥–æ user_id

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞:
```javascript
// UniFarmingCard.tsx, —Å—Ç—Ä–æ–∫–∞ 31
const { data: farmingResponse, isLoading } = useQuery<{ success: boolean; data: FarmingInfo }>({
  queryKey: ['/api/uni-farming/info?user_id=1'], // –î–æ–±–∞–≤–ª—è–µ–º user_id –≤ –∑–∞–ø—Ä–æ—Å
  refetchInterval: 10000, // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å
});
```

### –ü—Ä–æ–±–ª–µ–º–∞:
1. –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π user_id=1 –≤–º–µ—Å—Ç–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ —Å–æ–∑–¥–∞–µ—Ç –∏–∑–±—ã—Ç–æ—á–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä
3. –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –†–µ—à–µ–Ω–∏–µ:
```javascript
const { user } = useUser(); // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

const { data: farmingResponse, isLoading } = useQuery<{ success: boolean; data: FarmingInfo }>({
  queryKey: [`/api/uni-farming/info`, user?.id], // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π user_id
  refetchInterval: 30000, // –£–º–µ–Ω—å—à–∞–µ–º —á–∞—Å—Ç–æ—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
  enabled: !!user?.id, // –ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
});
```

---

## 3. –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞:
```javascript
// –û–±–Ω–æ–≤–ª—è–µ–º –∫—ç—à –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
queryClient.invalidateQueries({ queryKey: ['/api/wallet/balance'] });
queryClient.invalidateQueries({ queryKey: ['/api/me'] });

// –í –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ
queryClient.invalidateQueries({ queryKey: ['/api/uni-farming/info'] });
queryClient.invalidateQueries({ queryKey: ['/api/users/1'] });
queryClient.invalidateQueries({ queryKey: ['/api/wallet/balance'] });
queryClient.invalidateQueries({ queryKey: ['/api/transactions'] });
```

### –ü—Ä–æ–±–ª–µ–º–∞:
1. –†–∞–∑–Ω—ã–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–¥–µ –æ–±–Ω–æ–≤–ª—è—é—Ç —Ä–∞–∑–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
2. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–ª—é—á–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ ID (/api/users/1)
3. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –†–µ—à–µ–Ω–∏–µ:
```javascript
// –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
const refreshUserData = (userId) => {
  queryClient.invalidateQueries({ queryKey: ['/api/me'] });
  queryClient.invalidateQueries({ queryKey: ['/api/wallet/balance'] });
  queryClient.invalidateQueries({ queryKey: ['/api/uni-farming/info', userId] });
  queryClient.invalidateQueries({ queryKey: ['/api/users', userId] });
  queryClient.invalidateQueries({ queryKey: ['/api/transactions', userId] });
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
refreshUserData(user.id);
```

---

## 4. –ü—Ä–æ–±–ª–µ–º–∞: –ò–∑–±—ã—Ç–æ—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞:
```javascript
try {
  // –ü–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å try/catch
  try {
    // –í—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å try/catch
    try {
      // –¢—Ä–µ—Ç–∏–π —É—Ä–æ–≤–µ–Ω—å try/catch
      const fetchResponse = await fetch(url, fetchOptions);
      
      // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞
      const responseText = await fetchResponse.text();
      
      let response;
      try {
        // –ß–µ—Ç–≤–µ—Ä—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å try/catch
        response = JSON.parse(responseText);
      } catch (parseError) {
        console.error(`–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON:`, parseError);
        throw new Error(`–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON –≤ –æ—Ç–≤–µ—Ç–µ: ${parseError.message}`);
      }
      
    } catch (fetchError) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞:', fetchError);
      setError(`–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç: ${fetchError.message}`);
    }
  } catch (err) {
    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞:', err);
    setError(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞: ${err instanceof Error ? err.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
  }
} catch (err) {
  console.error('–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º—ã:', err);
  setError('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å—É–º–º—ã');
}
```

### –ü—Ä–æ–±–ª–µ–º–∞:
1. –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö try/catch –±–ª–æ–∫–æ–≤
2. –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
3. –ó–∞—Ç—Ä—É–¥–Ω–µ–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –æ—à–∏–±–∫–∏

### –†–µ—à–µ–Ω–∏–µ:
```javascript
try {
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
  if (!depositAmount || depositAmount === '0') {
    return setError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–µ–ø–æ–∑–∏—Ç–∞');
  }
  
  const amount = new BigNumber(depositAmount);
  if (amount.isNaN() || amount.isLessThanOrEqualTo(0)) {
    return setError('–°—É–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º');
  }
  
  if (amount.isGreaterThan(balance)) {
    return setError('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ');
  }
  
  // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
  const requestBody = {
    amount: String(amount),
    user_id: user.id
  };
  
  // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥
  const response = await apiRequest('/api/uni-farming/deposit', {
    method: 'POST',
    body: JSON.stringify(requestBody)
  });
  
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
  if (response.success) {
    setDepositAmount('');
    refreshUserData(user.id);
  } else {
    setError(response.error || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–ø–æ–∑–∏—Ç–∞');
  }
} catch (error) {
  // –ï–¥–∏–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
  console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–ø–æ–∑–∏—Ç–∞:', error);
  setError(`–û—à–∏–±–∫–∞: ${error.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
} finally {
  setIsSubmitting(false);
}
```

---

## 5. –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞ (App.tsx):
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–±–µ–∑ Telegram WebApp –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ñ–∞–∑—ã 10.3)
useEffect(() => {
  console.log('==[ App Init Check (No Telegram WebApp) ]==');
  console.log('Running in environment:', process.env.NODE_ENV);
  console.log('Window available:', typeof window !== 'undefined');
  
  // –®–∞–≥ 1.2 ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ initData –≤ Telegram WebApp
  console.log('==[ Guest ID Check ]==', 
    sessionRestoreService.getGuestId() || 'not found'
  );
  
  // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
  const urlParams = new URLSearchParams(window.location.search);
  console.log('==[ Ref Code Check ]==', {
    inUrl: urlParams.has('ref_code') || urlParams.has('refCode'),
    refCode: urlParams.get('ref_code') || urlParams.get('refCode') || 'not found',
    inSession: !!sessionStorage.getItem('referrer_code'),
    sessionRefCode: sessionStorage.getItem('referrer_code') || 'not found'
  });
}, []);

// –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Telegram –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
useEffect(() => {
  // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Telegram –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  // –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –±–æ—Ç–∞
  console.log('[App] üßπ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ Telegram –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
  clearTelegramCache();
  console.log('[App] ‚úÖ –ö—ç—à Telegram –æ—á–∏—â–µ–Ω, –æ–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ...');
}, []);

// –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç Telegram WebApp
useEffect(() => {
  console.log('[App] –≠—Ç–∞–ø 10.3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç Telegram WebApp');
  
  // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ä–µ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
  console.log('[App] –î–µ—Ç–∞–ª–∏ —Å—Ä–µ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:', {
    userAgent: navigator.userAgent,
    isIframe: window.self !== window.top,
    documentURL: window.location.href
  });
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Å—Å–∏—é –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
  if (sessionRestoreService.shouldAttemptRestore()) {
    console.log('[App] üîÑ –ü—ã—Ç–∞–µ–º—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Å—Å–∏—é –ø–æ guest_id –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞...');
    restoreSessionFromStorage();
  } else {
    // –ï—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ–±—ã—á–Ω—É—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
    console.log('[App] ‚öôÔ∏è –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–∏, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ guest_id...');
    authenticateWithTelegram();
  }
}, []);
```

### –ü—Ä–æ–±–ª–µ–º–∞:
1. –ù–µ—Å–∫–æ–ª—å–∫–æ useEffect –≤—ã–ø–æ–ª–Ω—è—é—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–µ–∑ —á–µ—Ç–∫–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞
2. –ú–Ω–æ–≥–æ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞—Ç—Ä—É–¥–Ω—è—é—Ç –ø–æ–∏—Å–∫ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
3. –°–ª–æ–∂–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –†–µ—à–µ–Ω–∏–µ:
```javascript
// –ï–¥–∏–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
useEffect(() => {
  const initializeApp = async () => {
    setIsLoading(true);
    
    try {
      // 1. –û—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
      clearTelegramCache();
      
      // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ URL
      const refCode = getReferrerCodeFromUrl();
      if (refCode) {
        sessionStorage.setItem('referrer_code', refCode);
        sessionStorage.setItem('referrer_code_timestamp', Date.now().toString());
      }
      
      // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏
      if (sessionRestoreService.shouldAttemptRestore()) {
        await restoreSessionFromStorage();
      } else {
        await authenticateWithTelegram();
      }
      
      // 4. –§–∏–Ω–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
      queryClient.invalidateQueries({ queryKey: ['/api/wallet/balance'] });
      queryClient.invalidateQueries({ queryKey: ['/api/me'] });
    } catch (error) {
      console.error('[App] –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
      setTelegramAuthError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è');
    } finally {
      setIsLoading(false);
    }
  };
  
  initializeApp();
}, []);
```

## 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—á–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞:**
   - –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ UniFarmReferralLink.tsx –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞ –ø—Ä–∏ –µ–≥–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏
   - –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º –∑–∞–ø—Ä–æ—Å–∞–º API –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Å–æ—Å—Ç–æ—è–Ω–∏—è

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏:**
   - –í–æ –º–Ω–æ–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö —Å—Ç–∞—Ç—É—Å isLoading –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
   - –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –Ω–∞–∂–∞—Ç–∏—è–º –Ω–∞ –∫–Ω–æ–ø–∫–∏ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤

3. **–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ queryClient:**
   - –°–º–µ—à–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ fetch –∏ React Query
   - –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º —Å —á–∞—Å—Ç–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤