# Журнал изменений UniFarm

## 20.05.2025
- **Архитектура**: Новая архитектура модулей БД с разделением ответственности
- **Добавлено**: Модуль db-config.ts для конфигурации подключения к БД
- **Добавлено**: Модуль db-health-monitor.ts для мониторинга состояния подключения
- **Добавлено**: Единый интерфейс db-connect-unified.ts для работы с БД
- **Добавлено**: Адаптер db-adapter.ts для обратной совместимости
- **Добавлено**: Универсальный обработчик ошибок БД с автоматическим восстановлением соединения
- **Добавлено**: Унифицированный подход к транзакциям с автоматической обработкой ошибок
- **Добавлено**: Автоматические тесты для проверки работы БД-соединения
- **Оптимизация**: Улучшена производительность запросов к БД для реферальной системы
- **Оптимизация**: Реализованы рекурсивные CTE для работы с реферальной структурой
- **Добавлено**: API-эндпоинты для тестирования и применения оптимизаций
- **Документация**: Обновлены инструкции по развертыванию БД-архитектуры

## 27.04.2025
- **Улучшение**: Изменен способ запуска production-версии приложения
- **Исправление**: Удален промежуточный файл production-deploy.cjs для более прямого запуска
- **Обновление**: Процесс деплоя теперь использует прямой запуск через `NODE_ENV=production node dist/index.js`
- **Документация**: Обновлены инструкции по деплою в production

## 26.04.2025
- **Добавлено**: Специальный модуль для корректной обработки статических файлов в production
- **Исправление**: Решены проблемы с 500 ошибками на маршрутах /UniFarm, /app, /telegram
- **Добавлено**: Обработка всех специальных путей для Telegram Mini App
- **Обновление**: Улучшена работа с production-доменом без указания порта

## 25.04.2025
- **Добавлено**: Интеграция с Telegram Mini App
- **Добавлено**: Система реферальных кодов с 20 уровнями
- **Добавлено**: Отслеживание и начисление партнерских бонусов
- **Добавлено**: Механизм восстановления аккаунта через guest_id