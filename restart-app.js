/**
 * –ë—ã—Å—Ç—Ä—ã–π restart –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
 */

import { spawn } from 'child_process';

console.log('üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');

// –£–±–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
try {
  spawn('pkill', ['-f', 'node'], { stdio: 'ignore' });
} catch (e) {}

// –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ
setTimeout(() => {
  console.log('üöÄ –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞...');
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å
  const child = spawn('npm', ['run', 'dev'], {
    detached: true,
    stdio: 'ignore'
  });
  
  child.unref();
  
  console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ!');
  console.log('üì± –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–µ.');
  
  process.exit(0);
}, 2000);